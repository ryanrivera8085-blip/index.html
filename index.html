<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Luminu</title>
<style>
body { margin:0; background:black; overflow:hidden; font-family:Arial; }
canvas { display:block; }

.btn {
  position:absolute;
  padding:15px 25px;
  border-radius:12px;
  border:2px solid cyan;
  background:rgba(0,200,255,0.25);
  color:white;
  font-size:16px;
}

.center { left:50%; transform:translateX(-50%); }

.hidden { display:none; }

h1 {
  color:white;
  text-align:center;
}
</style>
</head>
<body>

<!-- MENÚ -->
<div id="menu">
  <canvas id="menuCanvas"></canvas>
  <button class="btn center" style="bottom:220px" onclick="openBattle()">BATALLA</button>
  <button class="btn center" style="bottom:150px" onclick="openTraining()">ENTRENAMIENTO</button>
  <button class="btn center" style="bottom:80px">HISTORIA</button>
</div>

<!-- DIFICULTAD -->
<div id="difficulty" class="hidden">
  <h1>DIFICULTAD</h1>
  <button class="btn center" style="top:150px" onclick="startNormal()">NORMAL</button>
  <button class="btn center" style="top:220px">FÁCIL</button>
  <button class="btn center" style="top:290px">DIFÍCIL</button>
</div>

<!-- ENTRENAMIENTO -->
<div id="training" class="hidden">
  <h1>ENTRENAMIENTO</h1>
</div>

<!-- JUEGO -->
<canvas id="game" class="hidden"></canvas>
<button id="pulsoBtn" class="btn hidden" style="right:20px;bottom:120px">PULSO</button>
<button id="escudoBtn" class="btn hidden" style="right:120px;bottom:120px">ESCUDO</button>

<script>
/* ========= MENÚ ========= */
const menuCanvas = document.getElementById("menuCanvas");
menuCanvas.width = innerWidth;
menuCanvas.height = innerHeight;
const mctx = menuCanvas.getContext("2d");

function drawStickman() {
  mctx.clearRect(0,0,menuCanvas.width,menuCanvas.height);
  let x = menuCanvas.width/2, y = menuCanvas.height/2;
  mctx.strokeStyle="white"; mctx.lineWidth=4;
  mctx.beginPath(); mctx.arc(x,y-40,15,0,Math.PI*2); mctx.stroke();
  mctx.beginPath();
  mctx.moveTo(x,y-25); mctx.lineTo(x,y+30);
  mctx.moveTo(x-20,y); mctx.lineTo(x+20,y);
  mctx.moveTo(x,y+30); mctx.lineTo(x-20,y+60);
  mctx.moveTo(x,y+30); mctx.lineTo(x+20,y+60);
  mctx.stroke();
}
drawStickman();

/* ========= CAMBIOS DE PANTALLA ========= */
function openBattle(){
  document.getElementById("menu").style.display="none";
  document.getElementById("difficulty").style.display="block";
}
function openTraining(){
  document.getElementById("menu").style.display="none";
  document.getElementById("training").style.display="block";
}

/* ========= JUEGO ========= */
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
canvas.width = innerWidth;
canvas.height = innerHeight;

let luminu = {x:canvas.width/2,y:canvas.height/2,life:100,shield:100};
let enemies=[], pulses=[];
let pulsoReady=true, kills=0;

function startNormal(){
  document.getElementById("difficulty").style.display="none";
  canvas.classList.remove("hidden");
  document.getElementById("pulsoBtn").classList.remove("hidden");
  document.getElementById("escudoBtn").classList.remove("hidden");
  setInterval(spawnEnemy,1500);
  loop();
}

function spawnEnemy(){
  kills++;
  let type="normal";
  if(kills%15===0) type="boss";
  else if(kills%10===0) type="red";

  let e={x:Math.random()*canvas.width,y:Math.random()*canvas.height,type,hp:1};

  if(type==="red"){e.hp=2;e.speed=1.8;}
  else if(type==="boss"){e.hp=10;e.speed=0.4;}
  else{e.speed=1.2;}

  enemies.push(e);
}

document.getElementById("pulsoBtn").onclick=()=>{
  if(!pulsoReady) return;
  pulsoReady=false;
  pulses.push({r:0});
  setTimeout(()=>pulsoReady=true,5000);
};

document.getElementById("escudoBtn").onclick=()=>{
  luminu.shield=100;
};

function update(){
  enemies.forEach(e=>{
    let dx=luminu.x-e.x, dy=luminu.y-e.y;
    let d=Math.hypot(dx,dy);
    e.x+=dx/d*e.speed;
    e.y+=dy/d*e.speed;
    if(d<20){
      if(luminu.shield>0){
        luminu.shield-=e.type==="red"?3:1;
      }else luminu.life-=e.type==="boss"?2:0.5;
    }
  });

  pulses.forEach(p=>{
    p.r+=6;
    enemies.forEach(e=>{
      if(Math.hypot(luminu.x-e.x,luminu.y-e.y)<p.r){
        e.hp--;
      }
    });
  });

  enemies=enemies.filter(e=>e.hp>0);
}

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // Luminu
  ctx.strokeStyle="white"; ctx.lineWidth=3;
  ctx.beginPath(); ctx.arc(luminu.x,luminu.y-20,10,0,Math.PI*2); ctx.stroke();
  ctx.beginPath(); ctx.moveTo(luminu.x,luminu.y-10); ctx.lineTo(luminu.x,luminu.y+20); ctx.stroke();

  // Enemies
  enemies.forEach(e=>{
    ctx.fillStyle=e.type==="boss"?"purple":e.type==="red"?"red":"green";
    ctx.beginPath(); ctx.arc(e.x,e.y,e.type==="boss"?30:15,0,Math.PI*2); ctx.fill();
  });

  // UI
  ctx.fillStyle="red"; ctx.fillRect(20,20,luminu.life*2,10);
  ctx.fillStyle="cyan"; ctx.fillRect(20,40,luminu.shield*2,8);
}

function loop(){
  update();
  draw();
  requestAnimationFrame(loop);
}
</script>
</body>
</html>

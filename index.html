<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Luminu Mobile</title>

<style>
body {
  margin:0;
  background:black;
  overflow:hidden;
  touch-action:none;
}
canvas { display:block; }

.btn{
  position:absolute;
  width:70px;
  height:70px;
  border-radius:50%;
  background:rgba(0,200,255,0.3);
  border:2px solid cyan;
  color:white;
  font-size:14px;
}

#pulso{ right:20px; bottom:100px; }
#escudo{ right:100px; bottom:100px; }
</style>
</head>

<body>
<canvas id="game"></canvas>

<button class="btn" id="pulso">Pulso</button>
<button class="btn" id="escudo">Escudo</button>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
canvas.width = innerWidth;
canvas.height = innerHeight;

const pulsoBtn = document.getElementById("pulso");
const escudoBtn = document.getElementById("escudo");

// ðŸ”¹ LUMINU (PERSONA)
let luminu = {
  x: canvas.width/2,
  y: canvas.height/2,
  life:100,
  shield:false
};

// ðŸ‘¾ ZOMBIES
let enemies=[];
function spawnEnemy(){
  enemies.push({
    x:Math.random()*canvas.width,
    y:Math.random()*canvas.height,
    speed:0.4
  });
}
setInterval(spawnEnemy,2000);

// ðŸ•¹ï¸ JOYSTICK
let joy={active:false,sx:0,sy:0,dx:0,dy:0};

canvas.addEventListener("touchstart",e=>{
  let t=e.touches[0];
  if(t.clientX<canvas.width/2){
    joy.active=true;
    joy.sx=t.clientX;
    joy.sy=t.clientY;
  }
});
canvas.addEventListener("touchmove",e=>{
  if(!joy.active)return;
  let t=e.touches[0];
  joy.dx=t.clientX-joy.sx;
  joy.dy=t.clientY-joy.sy;
});
canvas.addEventListener("touchend",()=>{
  joy.active=false;
  joy.dx=joy.dy=0;
});

// ðŸ’¥ PULSO
let pulses=[];
let pulsoReady=true;
let cooldown=5;

function pulso(){
  if(!pulsoReady)return;
  pulsoReady=false;
  cooldown=5;
  pulses.push({r:0,max:200});

  let timer=setInterval(()=>{
    cooldown--;
    pulsoBtn.textContent=cooldown>0?cooldown:"Pulso";
    if(cooldown<=0){
      pulsoReady=true;
      clearInterval(timer);
    }
  },1000);
}
pulsoBtn.onclick=pulso;

// ðŸ›¡ï¸ ESCUDO
escudoBtn.onclick=()=>{
  luminu.shield=true;
  setTimeout(()=>luminu.shield=false,3000);
};

// ðŸ” UPDATE
function update(){
  luminu.x+=joy.dx*0.03;
  luminu.y+=joy.dy*0.03;

  enemies.forEach(e=>{
    let dx=luminu.x-e.x;
    let dy=luminu.y-e.y;
    let d=Math.hypot(dx,dy);
    e.x+=(dx/d)*e.speed;
    e.y+=(dy/d)*e.speed;
    if(d<25 && !luminu.shield) luminu.life-=0.2;
  });

  pulses.forEach((p,i)=>{
    p.r+=6;
    enemies=enemies.filter(e=>
      Math.hypot(luminu.x-e.x,luminu.y-e.y)>p.r
    );
    if(p.r>p.max)pulses.splice(i,1);
  });

  if(luminu.life<=0){
    alert("GAME OVER");
    location.reload();
  }
}

// ðŸŽ¨ DRAW
function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // Luminu persona
  ctx.fillStyle="white";
  ctx.beginPath(); ctx.arc(luminu.x,luminu.y-12,6,0,Math.PI*2); ctx.fill();
  ctx.fillRect(luminu.x-4,luminu.y-6,8,14);
  ctx.fillRect(luminu.x-8,luminu.y,16,4);

  // Escudo
  if(luminu.shield){
    ctx.strokeStyle="cyan";
    ctx.lineWidth=3;
    ctx.beginPath();
    ctx.arc(luminu.x,luminu.y,22,0,Math.PI*2);
    ctx.stroke();
  }

  // Zombies
  enemies.forEach(e=>{
    ctx.fillStyle="green";
    ctx.fillRect(e.x-6,e.y-6,12,12);
    ctx.fillStyle="darkgreen";
    ctx.fillRect(e.x-4,e.y-14,8,8);
  });

  // Pulso
  pulses.forEach(p=>{
    ctx.strokeStyle="blue";
    ctx.lineWidth=3;
    ctx.beginPath();
    ctx.arc(luminu.x,luminu.y,p.r,0,Math.PI*2);
    ctx.stroke();
  });

  // Vida
  ctx.fillStyle="red";
  ctx.fillRect(20,20,luminu.life*2,10);
}

function loop(){
  update();
  draw();
  requestAnimationFrame(loop);
}
loop();
</script>
</body>
</html>
